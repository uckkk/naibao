# å«å¥å§”æ•°æ®æ›´æ–°æœºåˆ¶ - ç®¡ç†å‘˜å‹å¥½æ–¹æ¡ˆ

## ğŸ“‹ ä¸€ã€éœ€æ±‚åˆ†æ

### 1.1 æ ¸å¿ƒéœ€æ±‚
- âœ… æ•°æ®å¯æ›´æ–°ï¼ˆæ¯å¹´å«å¥å§”å‘å¸ƒæ–°æ ‡å‡†ï¼‰
- âœ… ç®¡ç†å‘˜åå°ä¸€é”®æ›´æ–°
- âœ… å‰ç«¯å®æ—¶æ›´æ–°ï¼ˆæ— éœ€å‘ç‰ˆï¼‰
- âœ… æ›´æ–°ç­–ç•¥å¯¹ç®¡ç†å‘˜å‹å¥½

---

## ğŸ—ï¸ äºŒã€æ¶æ„è®¾è®¡

### 2.1 æ•°æ®å­˜å‚¨ç»“æ„

#### **æ–¹æ¡ˆï¼šé…ç½®è¡¨ + ç‰ˆæœ¬æ§åˆ¶**
```sql
-- å«å¥å§”æ ‡å‡†é…ç½®è¡¨
CREATE TABLE health_standards (
  id SERIAL PRIMARY KEY,
  version VARCHAR(20) NOT NULL,           -- ç‰ˆæœ¬å·ï¼š2025ã€2026...
  type VARCHAR(50) NOT NULL,              -- ç±»å‹ï¼šweight/height/milk/growth
  month_min INTEGER,                       -- æœ€å°æœˆé¾„
  month_max INTEGER,                       -- æœ€å¤§æœˆé¾„
  data JSONB NOT NULL,                     -- æ ‡å‡†æ•°æ®ï¼ˆJSONæ ¼å¼ï¼‰
  is_active BOOLEAN DEFAULT TRUE,          -- æ˜¯å¦æ¿€æ´»
  created_by INTEGER,                      -- åˆ›å»ºè€…ï¼ˆç®¡ç†å‘˜IDï¼‰
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ç¤ºä¾‹æ•°æ®
INSERT INTO health_standards (version, type, month_min, month_max, data) VALUES
('2025', 'milk_by_age', 0, 1, '{"min": 600, "max": 700, "unit": "ml/day"}'),
('2025', 'milk_by_age', 1, 3, '{"min": 700, "max": 900, "unit": "ml/day"}'),
('2025', 'milk_by_weight', NULL, NULL, '{"min": 120, "max": 150, "recommended": 135, "unit": "ml/kg/day"}'),
('2025', 'weight_gain', 0, 3, '{"min": 0.025, "max": 0.035, "unit": "kg/day"}'),
('2025', 'height_gain', 0, 3, '{"min": 8, "max": 11, "unit": "mm/day"}');
```

---

### 2.2 ç‰ˆæœ¬ç®¡ç†

#### **ç‰ˆæœ¬ç­–ç•¥ï¼š**
- ç‰ˆæœ¬å·æ ¼å¼ï¼š`YYYY`ï¼ˆå¦‚ï¼š2025ã€2026ï¼‰
- æ”¯æŒå¤šç‰ˆæœ¬å¹¶å­˜ï¼ˆå†å²æ•°æ®å…¼å®¹ï¼‰
- æ¯æ¬¡æ›´æ–°åˆ›å»ºæ–°ç‰ˆæœ¬ï¼Œæ—§ç‰ˆæœ¬ä¿ç•™
- æ¿€æ´»çŠ¶æ€ï¼šåªæœ‰æ¿€æ´»ç‰ˆæœ¬åœ¨å‰ç«¯ä½¿ç”¨

---

## ğŸ–¥ï¸ ä¸‰ã€åå°ç®¡ç†ç•Œé¢

### 3.1 ç®¡ç†å‘˜åå°åŠŸèƒ½

#### **åŠŸèƒ½æ¨¡å—ï¼š**
1. **æ ‡å‡†æ•°æ®ç®¡ç†**
   - æŸ¥çœ‹å½“å‰ç‰ˆæœ¬
   - åˆ›å»ºæ–°ç‰ˆæœ¬
   - ç¼–è¾‘æ ‡å‡†æ•°æ®
   - æ¿€æ´»/åœç”¨ç‰ˆæœ¬

2. **ä¸€é”®æ›´æ–°**
   - å¯¼å…¥æ–°æ ‡å‡†ï¼ˆExcel/JSONï¼‰
   - é¢„è§ˆå˜æ›´
   - ä¸€é”®å‘å¸ƒ

3. **ç‰ˆæœ¬å†å²**
   - æŸ¥çœ‹æ‰€æœ‰å†å²ç‰ˆæœ¬
   - ç‰ˆæœ¬å¯¹æ¯”
   - å›æ»šåˆ°æ—§ç‰ˆæœ¬

---

### 3.2 åå°ç•Œé¢è®¾è®¡

#### **ä¸»é¡µé¢ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å«å¥å§”æ ‡å‡†æ•°æ®ç®¡ç†                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å½“å‰æ¿€æ´»ç‰ˆæœ¬ï¼š2025                   â”‚
â”‚  æœ€åæ›´æ–°æ—¶é—´ï¼š2025-01-15 10:30      â”‚
â”‚                                      â”‚
â”‚  [åˆ›å»ºæ–°ç‰ˆæœ¬]  [ä¸€é”®æ›´æ–°]  [ç‰ˆæœ¬å†å²] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ‡å‡†æ•°æ®åˆ—è¡¨                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç±»å‹          â”‚ æœˆé¾„èŒƒå›´  â”‚ æ•°æ®      â”‚
â”‚  æŒ‰ä½“é‡å¥¶é‡    â”‚ -         â”‚ 120-150   â”‚
â”‚  æŒ‰æœˆé¾„å¥¶é‡    â”‚ 0-1æœˆ     â”‚ 600-700   â”‚
â”‚  æŒ‰æœˆé¾„å¥¶é‡    â”‚ 1-3æœˆ     â”‚ 700-900   â”‚
â”‚  æ—¥å‡å¢é‡      â”‚ 0-3æœˆ     â”‚ 0.025-0.035â”‚
â”‚  æ—¥å‡å¢é«˜      â”‚ 0-3æœˆ     â”‚ 8-11      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **ä¸€é”®æ›´æ–°é¡µé¢ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸€é”®æ›´æ–°å«å¥å§”æ ‡å‡†                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. é€‰æ‹©æ›´æ–°æ–¹å¼ï¼š                    â”‚
â”‚     â—‹ å¯¼å…¥Excelæ–‡ä»¶                  â”‚
â”‚     â—‹ å¯¼å…¥JSONæ–‡ä»¶                   â”‚
â”‚     â—‹ æ‰‹åŠ¨è¾“å…¥                       â”‚
â”‚                                      â”‚
â”‚  2. ä¸Šä¼ æ–‡ä»¶ï¼š                        â”‚
â”‚     [é€‰æ‹©æ–‡ä»¶] å«å¥å§”æ ‡å‡†2026.xlsx    â”‚
â”‚                                      â”‚
â”‚  3. é¢„è§ˆå˜æ›´ï¼š                        â”‚
â”‚     ç‰ˆæœ¬ï¼š2026                        â”‚
â”‚     å˜æ›´é¡¹ï¼š                          â”‚
â”‚     â€¢ æŒ‰ä½“é‡å¥¶é‡ï¼š135 â†’ 140 ml/kg   â”‚
â”‚     â€¢ 0-1æœˆå¥¶é‡ï¼š600-700 â†’ 650-750   â”‚
â”‚     ...                               â”‚
â”‚                                      â”‚
â”‚  4. ç¡®è®¤æ›´æ–°ï¼š                        â”‚
â”‚     [å–æ¶ˆ]  [ç¡®è®¤æ›´æ–°]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.3 åå°æŠ€æœ¯å®ç°

#### **æŠ€æœ¯æ ˆï¼š**
```
åå°ç®¡ç†ç³»ç»Ÿ
â”œâ”€ æ¡†æ¶ï¼šVue 3 + Element Plusï¼ˆæˆ– Ant Design Vueï¼‰
â”œâ”€ åç«¯ï¼šGo + Ginï¼ˆå¤ç”¨ä¸»æœåŠ¡ï¼‰
â”œâ”€ è®¤è¯ï¼šJWTï¼ˆç®¡ç†å‘˜æƒé™ï¼‰
â””â”€ æ–‡ä»¶ä¸Šä¼ ï¼šæ”¯æŒExcel/JSONå¯¼å…¥
```

#### **APIæ¥å£ï¼š**
```go
// è·å–å½“å‰æ¿€æ´»ç‰ˆæœ¬
GET /admin/standards/current

// åˆ›å»ºæ–°ç‰ˆæœ¬
POST /admin/standards/version
Request: {
  version: "2026",
  standards: [
    { type: "milk_by_weight", data: {...} },
    ...
  ]
}

// ä¸€é”®æ›´æ–°ï¼ˆå¯¼å…¥æ–‡ä»¶ï¼‰
POST /admin/standards/import
Request: FormData {
  file: File,
  version: "2026"
}

// æ¿€æ´»ç‰ˆæœ¬
PUT /admin/standards/:version/activate

// è·å–ç‰ˆæœ¬åˆ—è¡¨
GET /admin/standards/versions

// ç‰ˆæœ¬å¯¹æ¯”
GET /admin/standards/compare?version1=2025&version2=2026
```

---

## ğŸ“± å››ã€å‰ç«¯æ›´æ–°æœºåˆ¶

### 4.1 æ•°æ®è·å–ç­–ç•¥

#### **æ–¹æ¡ˆï¼šç‰ˆæœ¬å· + ç¼“å­˜ + è½®è¯¢**
```javascript
// 1. å¯åŠ¨æ—¶è·å–ç‰ˆæœ¬å·
async function checkVersion() {
  const currentVersion = await api.get('/standards/version');
  const localVersion = uni.getStorageSync('health_standard_version');
  
  // å¦‚æœç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œæ›´æ–°æ•°æ®
  if (currentVersion !== localVersion) {
    await updateStandards(currentVersion);
  }
}

// 2. è·å–æ ‡å‡†æ•°æ®ï¼ˆå¸¦ç¼“å­˜ï¼‰
async function getStandards() {
  const cached = uni.getStorageSync('health_standards');
  const version = uni.getStorageSync('health_standard_version');
  
  // å¦‚æœç¼“å­˜å­˜åœ¨ä¸”ç‰ˆæœ¬ä¸€è‡´ï¼Œç›´æ¥ä½¿ç”¨
  if (cached && version === currentVersion) {
    return cached;
  }
  
  // å¦åˆ™ä»æœåŠ¡å™¨è·å–
  const data = await api.get('/standards/current');
  uni.setStorageSync('health_standards', data);
  uni.setStorageSync('health_standard_version', data.version);
  return data;
}

// 3. å®šæ—¶æ£€æŸ¥æ›´æ–°ï¼ˆæ¯5åˆ†é’Ÿï¼‰
setInterval(async () => {
  await checkVersion();
}, 5 * 60 * 1000);
```

---

### 4.2 å®æ—¶æ›´æ–°ï¼ˆWebSocketæ¨é€ï¼‰

#### **æ–¹æ¡ˆï¼šç‰ˆæœ¬å˜æ›´æ¨é€**
```javascript
// WebSocketç›‘å¬ç‰ˆæœ¬æ›´æ–°
ws.on('standard_updated', (data) => {
  const { version, timestamp } = data;
  
  // æ˜¾ç¤ºæç¤º
  uni.showModal({
    title: 'æ ‡å‡†å·²æ›´æ–°',
    content: `å«å¥å§”${version}å¹´æ ‡å‡†å·²æ›´æ–°ï¼Œæ˜¯å¦ç«‹å³åˆ·æ–°ï¼Ÿ`,
    success: (res) => {
      if (res.confirm) {
        // é‡æ–°è·å–æ•°æ®
        await updateStandards(version);
        // é‡æ–°è®¡ç®—æ¨èå¥¶é‡
        recalculateRecommendations();
      }
    }
  });
});
```

---

## ğŸ“Š äº”ã€æ•°æ®æ ¼å¼è®¾è®¡

### 5.1 Excelæ¨¡æ¿ï¼ˆç®¡ç†å‘˜å¯¼å…¥ç”¨ï¼‰

#### **æ¨¡æ¿ç»“æ„ï¼š**
```
| ç±»å‹ | æœˆé¾„æœ€å° | æœˆé¾„æœ€å¤§ | æœ€å°å€¼ | æ¨èå€¼ | æœ€å¤§å€¼ | å•ä½ | è¯´æ˜ |
|------|---------|---------|-------|-------|-------|------|------|
| milk_by_weight | - | - | 120 | 135 | 150 | ml/kg/day | æŒ‰ä½“é‡å¥¶é‡ |
| milk_by_age | 0 | 1 | 600 | 650 | 700 | ml/day | 0-1æœˆå¥¶é‡ |
| milk_by_age | 1 | 3 | 700 | 800 | 900 | ml/day | 1-3æœˆå¥¶é‡ |
| weight_gain | 0 | 3 | 0.025 | 0.030 | 0.035 | kg/day | æ—¥å‡å¢é‡ |
| height_gain | 0 | 3 | 8 | 9.5 | 11 | mm/day | æ—¥å‡å¢é«˜ |
```

---

### 5.2 JSONæ ¼å¼ï¼ˆAPIè¿”å›ï¼‰

```json
{
  "version": "2025",
  "updatedAt": "2025-01-15T10:30:00Z",
  "standards": {
    "milkByWeight": {
      "min": 120,
      "max": 150,
      "recommended": 135,
      "unit": "ml/kg/day"
    },
    "milkByAge": [
      {
        "monthMin": 0,
        "monthMax": 1,
        "min": 600,
        "max": 700,
        "unit": "ml/day"
      },
      {
        "monthMin": 1,
        "monthMax": 3,
        "min": 700,
        "max": 900,
        "unit": "ml/day"
      }
    ],
    "weightGain": [
      {
        "monthMin": 0,
        "monthMax": 3,
        "min": 0.025,
        "max": 0.035,
        "unit": "kg/day"
      }
    ],
    "heightGain": [
      {
        "monthMin": 0,
        "monthMax": 3,
        "min": 8,
        "max": 11,
        "unit": "mm/day"
      }
    ]
  }
}
```

---

## âœ… å…­ã€å®æ–½è®¡åˆ’

### Phase 1ï¼šæ•°æ®åº“å’ŒAPIï¼ˆWeek 1ï¼‰
- [ ] åˆ›å»ºhealth_standardsè¡¨
- [ ] å®ç°æ ‡å‡†æ•°æ®CRUD API
- [ ] å®ç°ç‰ˆæœ¬ç®¡ç†API

### Phase 2ï¼šåå°ç®¡ç†ï¼ˆWeek 2ï¼‰
- [ ] åå°ç®¡ç†ç•Œé¢å¼€å‘
- [ ] Excel/JSONå¯¼å…¥åŠŸèƒ½
- [ ] ä¸€é”®æ›´æ–°åŠŸèƒ½
- [ ] ç‰ˆæœ¬å¯¹æ¯”åŠŸèƒ½

### Phase 3ï¼šå‰ç«¯æ›´æ–°ï¼ˆWeek 3ï¼‰
- [ ] ç‰ˆæœ¬æ£€æŸ¥æœºåˆ¶
- [ ] æ•°æ®ç¼“å­˜æœºåˆ¶
- [ ] WebSocketæ¨é€
- [ ] æ›´æ–°æç¤ºUI

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**åˆ›å»ºæ—¶é—´ï¼š** 2025å¹´1æœˆ

