# 剩余优化项 Backlog（基于目标的全盘审计）

> 目的：站在“宝爸宝妈”的真实使用场景（夜间、单手、弱网、焦虑）与 iOS 的信息层级理念出发，把还值得做的优化收敛成**可执行**清单（含验收标准），便于持续迭代而不跑偏。

## 0. 北极星目标（不变）

- **一眼看懂**：打开即知“下次喂奶什么时候/还有多久/今天节奏是否需要留意”。
- **一键完成**：高频动作（投喂、撤销、补录/编辑）≤ 2 步完成，且可撤销优先于反复确认。
- **低打扰、可解释**：只有“明显不合理”才打断；其余用温和提示，并能解释“为什么”与“下一步做什么”。
- **弱网可用**：弱网/离线时不空白、不丢数据；恢复后能同步。
- **本地化**：24 小时制、中文日期表达（明天/后天）、避免评判式文案。

## 1. 现状：已达成的关键体验基线（摘要）

- 全站弱网/错误/空态/骨架屏/确认 Sheet 交互收敛（更像一个产品而不是页面集合）。
- 首页信息减法 + 24h 时间轴（记录点、下次点、现在线），并支持左滑编辑/删除、撤销条提醒。
- 提醒体系：应用内倒计时 + H5 系统通知权限开关与测试（受 iOS/PWA 限制已给出引导文案）。
- 奶粉选择补齐“段数可改”，且可引导开启 7 天转奶期。
- 喂奶记录支持编辑“奶量 + 日期/时间”，避免错记导致倒计时异常。

## 2. 剩余优化项（按优先级）

### P0（上线/长期稳定的硬门槛）

1) **线上稳定运行与成本最小化方案落地**
   - 问题：当前可通过 trycloudflare 预览，但不是“长期线上”形态；缺少域名、HTTPS、备份、可观测与升级路径。
   - 验收：
     - 有一个可长期访问的域名（国内访问稳定），前端静态托管 + 后端 API + 数据库均可恢复。
     - 数据库每天自动备份（至少保留 7 天）+ 一键恢复演练记录。
     - 基础监控：CPU/内存/磁盘/DB 连接数/慢查询；告警渠道（微信/短信二选一）。

2) **安全与滥用防护（公开互联网必做）**
   - 问题：手机号密码登录在公网需要最小风控，否则易被撞库/暴力尝试。
   - 建议：登录/注册限流（IP + 账号维度）、JWT 失效策略、审计日志留存与脱敏。
   - 验收：
     - 连续错误登录触发限流（返回统一错误，不泄露用户是否存在）。
     - 关键操作（删记录/移除成员/改密码）有审计日志。

3) **家庭协作权限模型全链路复核**
   - 问题：多成员共用同一宝宝时，所有接口必须以 “ensureBabyMember” 一致校验，否则会出现“部分页能看、部分页空/403”。
   - 验收：
     - admin 与 member 的能力矩阵明确（谁能改宝宝资料/改奶粉/删他人记录）。
     - Playwright/冒烟脚本覆盖“成员视角”的关键链路。

### P1（高价值、低风险：优先做这些）

1) **冲泡要求缺失时的“自定义冲泡规格”（显著提升可用性）**
   - 现状：很多品牌没有官方规格数据，用户只能看到“暂无数据”，但现实里父母最想要“勺数/水温/步骤”。
   - 建议：在“冲泡要求”页提供“手动录入”（先做最小字段：`ml/勺`、`水温范围`、`步骤（可选）`）。
   - 实现策略（低风险优先）：
     - v1：先本机存储（按 babyId + brandId + series/段数 key），不改后端 schema；首页计算勺数时优先用自定义 spec。
     - v2：再同步到后端（家庭共享一致）。
   - 验收：
     - 无官方 spec 时，用户可在 30 秒内完成录入并在首页/记录中生效。
     - 录入后不会引入 CLS/排版跳动；弱网下仍可读取本机录入值。

2) **新手上手成本再降：Setup Nudge（轻量引导 + 可关闭）**
   - 目标：首次进入不用读说明也知道下一步该做什么（建档/间隔/奶粉可选）。
   - 验收：
     - 没建档 → 首页只展示一个明确 CTA（去建档）。
     - 已建档但未设置间隔/提醒 → 首页出现一条轻提示（不超过一行），可一键跳到设置。
     - 用户关闭后不再打扰（本机记忆）。

3) **报告页/帮助页的“全站一致”体验补齐**
   - 问题：部分页面未接入 LoadingSwitch/State，弱网下更容易“像页面集合”。
   - 验收：
     - 报告页生成中有骨架/加载态；错误态用 NbState（含重试）；空态引导去记录。
     - 帮助页结构更像系统设置（短标题 + 一句话答案/可展开）。

4) **提醒体系“可被信任”的细节补齐**
   - 建议：在“喂奶间隔/提醒”页加入“为什么收不到系统通知”的分支引导（iOS/PWA），并提供“添加到主屏幕”的图示步骤。
   - 验收：用户能在 1 分钟内自助判断“当前设备是否支持/如何开启”。

### P2（中长期：做了会更强，但不阻塞）

1) **离线记录队列（Offline-first）**
   - 场景：半夜弱网/断网也要能记录；恢复网络后自动同步，避免丢数据。
   - 验收：离线可记录 ≥ 20 条；恢复后自动补传；冲突策略明确（按时间/按 id）。

2) **PWA（离线缓存 + 安装到桌面 + 体验更像 App）**
   - iOS Web Push 受限：需要 Service Worker + 用户安装到桌面；推进需配合产品策略。

3) **商业化与增长（不影响信任前提下）**
   - CPS：购买链接明确标注；可按用户偏好（京东/天猫/拼多多）跳转；后续可做“优惠价提醒/比价”。
   - 会员：家庭成员上限/导出报告/长期历史等作为自然付费点。

## 3. 推荐的下一批落地顺序（默认）

1) 自定义冲泡规格（P1-1）
2) Setup Nudge（P1-2）
3) 报告页/帮助页体验补齐（P1-3）
4) 上线方案与安全/权限复核（P0）

