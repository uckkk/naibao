# 冗余清理执行记录

> 目标：在不引入行为回归的前提下，进一步降低维护成本、减少端差异与构建困惑。
> 本记录包含“清理项 + 已执行结果 + 回归口径”，便于后续追溯。

## 1) 前端：重复页面/旧实现（高收益，低风险）

### A. `frontend/src/pages/home/index.nvue`（已删除）

- 现状：`pages.json` 当前入口为 `pages/home/index`（`.vue`），`.nvue` 不在路由里引用。
- 风险：若未来要做 `App` 端 nvue 性能优化，这个文件可能会被重新启用。
- 建议：若短期目标是 “H5 + 微信小程序” 上线，建议删除，避免两套首页实现长期漂移。

### B. `frontend/src/utils/router.js` / `frontend/src/utils/uni-polyfill.js` / `frontend/src/utils/picker-polyfill.js`（已删除）

- 现状：已切回官方 `uni` CLI + `uni-h5` 运行时后，上述文件在 `frontend/src` 内无引用（仅互相引用）。
- 风险：极低（删除后如有遗漏引用，构建会直接报错，容易回滚）。
- 建议：删除，避免误导后续维护者继续沿用“自研路由/polyfill”路线。

## 2) 测试：旧脚本替代（中收益，低风险）

### `scripts/e2e_h5_check.mjs`（已删除）

- 现状：这是早期“直接用 Playwright API 写脚本”的版本；当前已使用 `@playwright/test` 的 `scripts/e2e_h5_check.spec.js` 作为主 E2E。
- 风险：低；若有人仍在本地手动跑该脚本，需要同步更新文档与入口。
- 建议：删除（或至少在文件头部标注 deprecated 并从文档入口移除）。

## 3) 产物：忽略规则（已执行）

- 已在 `.gitignore` 中新增：`test-results/`、`playwright-report/`（避免测试产物污染仓库）

## 4) 删除后回归（已执行）

- `cd frontend && npm run build:h5`
- `cd frontend && npm run build:mp-weixin`
- `python3 scripts/smoke_test.py`
- `npx playwright test scripts/e2e_h5_check.spec.js --workers=1`
